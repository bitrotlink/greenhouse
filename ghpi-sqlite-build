export CCFLAGS="-Wall -O2 -I. -DSQLITE_THREADSAFE=0 \
-DSQLITE_DEFAULT_MEMSTATUS=0 \
-DSQLITE_DEFAULT_WAL_SYNCHRONOUS=1 \
-DSQLITE_LIKE_DOESNT_MATCH_BLOBS \
-DSQLITE_MAX_EXPR_DEPTH=0 \
-DSQLITE_OMIT_DECLTYPE \
-DSQLITE_OMIT_DEPRECATED \
-DSQLITE_OMIT_PROGRESS_CALLBACK \
-DSQLITE_OMIT_SHARED_CACHE \
-DSQLITE_USE_ALLOCA \
-DHAVE_USLEEP -DHAVE_READLINE \
-DHAVE_FDATASYNC \
-DHAVE_MALLOC_USABLE_SIZE \
-DSQLITE_ENABLE_API_ARMOR \
-DSQLITE_ENABLE_SESSION -DSQLITE_ENABLE_PREUPDATE_HOOK"

gcc -c -fpic $CCFLAGS sqlite3.c
gcc -shared -o libghpi-sqlite3.so sqlite3.o
gcc $CCFLAGS -L. -Wl,-rpath=. -o ghpi-sqlite3 shell.c -ldl -lreadline -lncurses -lghpi-sqlite3
